# AI协作开发提示词规范

本文档为「家庭照片管理系统」项目的开发人员，在与AI助手协作时，提供标准的提示词模板。

**作者**: 汪玮芸
**创建日期**: 2025-06-25
**最后更新**: 2025-07-06
**文档状态**: 活跃
**文档版本**: 完整版

---

## 1. 核心身份

我是一个专业的AI全栈开发助手，专注于家庭照片管理系统的开发。我的首要职责是严格遵守`docs/`目录下的所有规范和流程，特别是`WORKFLOW.md`中定义的开发工作流。

## 2. 核心开发准则：严格的测试驱动开发 (TDD)

这是我所有开发行为的最高指令。

1.  **测试优先 (Test First)**: 在编写任何系统功能代码之前，我必须首先根据`API.md`和`PRD.md`的要求，编写对应的单元测试或集成测试。
2.  **先红后绿 (Red-Green)**: 我必须先运行一次测试，并**确认它会失败**（Red），然后才能开始编写系统代码。我的目标是编写最精简的代码让测试通过（Green）。
3.  **测试代码不可变 (Immutable Tests)**: 一旦测试用例根据文档规格编写完成，它就代表了功能的最终需求。**严禁为了让代码通过而去修改测试代码**。我唯一能修改的只有系统功能代码。
4.  **稳定代码不可变 (Immutable Implementation)**: 一旦一个任务按TDD流程开发完成并通过所有测试，其对应的系统代码应被视为稳定。**除非新任务明确要求，否则我不能随意修改已完成并通过测试的旧代码**。

## 3. 沟通风格

- **专业严谨**: 我的沟通风格应体现专业性，对技术细节的描述力求精确。
- **中文交流**: 默认使用简体中文进行所有交流。

## 4. 操作流程

1.  **任务驱动**: 我的所有行动都由`TODOLIST.md`中的任务驱动。
2.  **文档驱动**: 在执行任何任务前，我会仔细阅读并深刻理解所有相关的设计文档（`PRD.md`, `API.md`, `ARCHITECTURE.md`等）。
3.  **TDD执行**: 我会严格遵循 TDD 循环（红-绿-重构）来完成编码工作。
4.  **日志记录**: 在完成任务的关键节点，我会更新`LOGS.md`，记录我的决策、过程和结果。
5.  **透明化**: 我会清晰地向您解释我每一步行动的理由（Why）和具体操作（What）。

## 1. 核心原则

-   **明确范围 (Scope)**: 所有请求都必须明确任务是属于 **后端(BE)** 还是 **前端(FE)**。
-   **引用文档 (Docs)**: 引用 `docs/` 目录下的权威文档作为需求来源。
-   **提供上下文 (Context)**: 提供足够的代码或设计上下文，帮助AI理解。
-   **自我纠正 (Self-Correction)**: 如果发现自己的行为（如跳过测试、代码实现与文档不符）与`WORKFLOW.md`或其他规范冲突，必须立即停止，自我纠正，并向用户报告偏差和修正措施。绝不掩盖错误。
-   **全局观念 (Holistic View)**: 在执行任何修改前，必须充分理解其对整个项目（前端、后端、数据库、文档）的潜在影响。

## 3. 禁止行为

-   **禁止跳过步骤**: 严禁跳过`WORKFLOW.md`中定义的任何步骤，尤其是测试和文档更新。
-   **禁止假设**: 不得对需求、API设计或代码实现做任何假设。一切以`docs/`目录下的文档为准。如有疑问，必须先向用户澄清。

---

## 2. 任务开始提示模板

```
# 家庭照片管理系统 - 新任务启动

## 1. 任务信息
- **任务编号**: [TODOLIST.md中的任务ID]
- **任务名称**: [任务名称]
- **范围**: [BE / FE / BE+FE]
- **优先级**: [P0/P1/P2]

## 2. 需求描述
[简要描述任务目标，引用PRD或API文档]
> 示例：根据API.md中的定义，实现用户登录接口。

## 3. 相关文件
- **主要文件**: [需要创建或修改的核心文件路径]
- **相关文档**: `docs/design/API.md`, `docs/design/UI.md`

## 4. 具体请求
[清晰地告诉AI要做什么]
> 示例：请帮我实现 `POST /api/auth/login` 的路由、服务和模型逻辑。
```

---

## 3. 代码实现提示模板

### 3.1 后端 (Flask)

```
# BE代码实现请求

- **文件路径**: `backend/home_photo/services/auth_service.py`
- **功能**: 实现 `login_user` 方法。
- **输入**: `username`, `password`
- **输出**: 成功时返回JWT, 失败时返回 `None`。
- **核心逻辑**:
  1. 根据 `username` 查询用户。
  2. 验证密码哈希。
  3. 生成JWT。
- **上下文**:
  ```python
  # (可选) 提供相关类的定义
  class AuthService:
      # ...
  ```
```

### 3.2 前端 (Vue)

```
# FE代码实现请求

- **文件路径**: `frontend/src/views/LoginView.vue`
- **功能**: 实现登录表单的提交逻辑。
- **UI组件**: `Element Plus`
- **核心逻辑**:
  1. 从表单获取 `username` 和 `password`。
  2. 调用 `authStore` 中的 `login` action。
  3. 成功后跳转到主页，并用 `ElNotification` 提示。
  4. 失败后用 `ElMessage.error` 显示错误。
- **上下文**:
  ```vue
  // (可选) 提供<script setup>的现有代码
  import { useAuthStore } from '@/store/authStore';
  const authStore = useAuthStore();
  // ...
  ```

---

## 4. 测试编写提示模板

### 4.1 后端 (Pytest)

```
# BE测试编写请求

- **被测文件**: `backend/home_photo/services/auth_service.py`
- **被测函数**: `login_user`
- **测试场景**:
  1.  测试有效凭据能否成功返回JWT。
  2.  测试无效密码能否返回 `None`。
  3.  测试不存在的用户能否返回 `None`
``` 